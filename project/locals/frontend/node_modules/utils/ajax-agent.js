
import request from 'superagent-bluebird-promise'
import nocache from 'superagent-no-cache'

let defaultHeader = {
    Accept: 'application/json'
}

function agent(method, url, data = {}, header = {}) {
    return request(method, url)
        .set(Object.assign(header, defaultHeader))
        .use(nocache)
        .send(data)
        .then(response => JSON.parse(response.text), error => {
            if (error.status == 403) {
                window.top.location.href = '/bprouting/BpFlowRouting?appindex=true'
            }
        })
}

agent.get = function(url, data, header = {}) {
    return agent('get', url, data, header)
}

agent.post = function(url, data, header) {
    return agent('post', url, data, header)
}

export default agent

