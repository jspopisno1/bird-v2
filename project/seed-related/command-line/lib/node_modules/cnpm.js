var sp = require('common/sp')

/**
 *
 * @param path {String} 在特定的path下运行  cnpm install -d
 * @param modules {String} 如果 modules 非空, 则安装特定的modules
 * @param isDev {Boolean} 如果指定为 isDev, 则会加入 --save-dev 的标识
 * @returns {Promise.<T>|*}
 */
module.exports = function (path, modules, isDev) {
    return sp(
        ['cnpm install -d ',
            // 欲安装的 modules
            modules ? modules : '',
            // 如果有指定 modules, 是否是 dev 所需
            modules ? (isDev ? '--save-dev' : '--save') : ''].join(' '),
        
        // 运行 cnpm 的位置
        {cwd: path})
        .catch(function (err) {
            console.error('[ERROR] cnpm is not found, please make sure it is installed.')
            console.info('[HINT] Also make sure you are using cnpm from npm install of a custom alias.')
            console.info('[INFO] NOTE that you should try to install cnpm@3.x.x instead of cnpm@4.x.x for now.')
        })
}